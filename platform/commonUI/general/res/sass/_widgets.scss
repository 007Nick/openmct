/*****************************************************************************
 * Open MCT, Copyright (c) 2014-2017, United States Government
 * as represented by the Administrator of the National Aeronautics and Space
 * Administration. All rights reserved.
 *
 * Open MCT is licensed under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0.
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations
 * under the License.
 *
 * Open MCT includes source code licensed under additional open source
 * licenses. See the Open Source Licenses file (LICENSES.md) included with
 * this source code distribution or the Licensing information page available
 * at runtime from the About dialog for additional information.
 *****************************************************************************/

/************************************************************* WIDGET OBJECT */
.l-summary-widget {
    // Widget layout classes here
    @include ellipsize();
    display: inline-block;
    text-align: center;
}

.s-summary-widget {
    // Widget style classes here
    border-radius: $basicCr;
    border-style: solid;
    border-width: 1px;
    box-sizing: border-box;
    padding: $interiorMarginLg $interiorMarginLg * 2;
}

.l-widget-outer-w,
.widget-holder,
.widget-edit-holder {
    // In browse mode, all these things should be at .abs default
    @extend .abs;
}

.widget-edit-holder {
    // Hide edit area when in browse mode
    display: none;
}

.widget-rule-header {
    @extend .l-flex-row;
    @include align-items(center);
    margin-bottom: $interiorMargin;
    > .flex-elem {
        &:not(:first-child) {
            margin-left: $interiorMargin;
        }
    }
}

.widget-rule-content {
    @include trans-prop-nice($props: (height, min-height), $dur: 250ms);
    min-height: 0;
    height: 0;
    overflow: hidden;
    &.expanded {
        min-height: 50px;
        height: auto;
        overflow: visible;
    }
}

.l-widget-thumb-w,
.l-compact-form label {
    $ruleLabelW: 40%;
    $ruleLabelMaxW: 150px;
    @include display(flex);
    max-width: $ruleLabelMaxW;
    width: $ruleLabelW;
}

/********************************************************** EDITING A WIDGET */
.s-status-editing .l-widget-outer-w {
    $widgetHolderH: 100px;
    @extend .abs;
    //overflow: hidden; // Overflow scroll is handled by internal elements

    .widget-holder {
        bottom: auto;
        height: $widgetHolderH;
        .l-summary-widget {
            display: inline-block;
            position: absolute;
            top: 50%; left: 50%;
            @include transform(translateX(-50%) translateY(-50%));
        }
    }

    .widget-edit-holder {
        @extend .l-flex-col;
        display: block; // Needed to counteract display: none while browsing
        overflow-y: scroll;
        padding-right: $interiorMargin;
        top: $widgetHolderH + $interiorMargin;
    }


    
    .widget-test-data,
    .widget-rules-w {
        @include test(blue, 0.1);
    }
    
    .widget-test-data {

    }

    .widget-rules-w {
        // Wrapper area that holds n rules
        @extend .flex-elem;
        box-sizing: border-box;
        font-size: 0.8em;
    }

    .l-widget-rule {
        box-sizing: border-box;
        margin-bottom: $interiorMargin;
        padding: $interiorMarginLg;
    }

    .l-widget-thumb-w {
        @extend .l-flex-row;
        @include align-items(center);
        > span { display: block; }
        .grippy-holder,
        .view-control {
            margin-right: $interiorMargin;
            width: 1em;
            height: 1em;
        }

        .widget-thumb {
            @include flex(1 1 auto);
        }
    }

    .rule-title {
        @include flex(0 1 auto);
        color: pullForward($colorBodyFg, 50%);
    }

    .rule-description {
        @include flex(1 1 auto);
        @include ellipsize();
        color: pushBack($colorBodyFg, 20%);
    }

    .s-widget-rule {
        background-color: rgba($colorBodyFg, 0.1);
        border-radius: $basicCr;
    }

    .widget-thumb {
        @include ellipsize();
        @extend .s-summary-widget;
        @extend .l-summary-widget;
        padding: $interiorMarginSm $interiorMargin;
        .widget-icon {
            font-size: 0.8em;
            }
    }

    // Hide and show elements in the rule-header on hover
    .l-widget-rule {
        .grippy,
        .l-rule-action-buttons-w,
        .l-condition-action-buttons-w {
            @include trans-prop-nice($props: opacity, $dur: 500ms);
            opacity: 0;
        }
        &:hover {
            .grippy,
            .l-rule-action-buttons-w,
            .l-condition-action-buttons-w {
                @include trans-prop-nice($props: opacity, $dur: 0);
                opacity: 1;
            }
        }
    }


    .l-compact-form {
        // Overrides
        ul li {
            padding: $interiorMargin 0;
            &:not(.widget-rule-header) {
                &:not(.connects-to-previous) {
                    border-top: 1px solid $colorFormLines;
                }
            }
            &.connects-to-previous {
                padding: $interiorMargin 0;
            }
        }

        label {
            display: block; // Needed to align text to right
            text-align: right;
        }
    }
}